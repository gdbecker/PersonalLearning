## 19_ Vulnerability Scanning and Reporting

### Certificate
!["Certificate"](./19_VulnerabilityScanningReporting.jpg)

### Intro
- Vulnerability scanning and analysis is the process that detects and assesses the vulnerabilities that exist within a network infrastructure
- To prevent security breaches, it's important to identify and remediate security holes and vulnerabilities that can expose an asset to an attack
- You can use Nexpose to scan a network for vulnerabilities
- Nexpose identifies the active services, open ports, and running apps on each machine, and it attempts to find vulnerabilities that may exist
- Nexpose discloses the results in a scan report, which helps you prioritize vulnerabilities, based on the risk factors and determine the most effective solution to implement

### What is Nexpose?
- Rapid7 Nexpose is a vulnerability scanner that aims to support the entire vulnerability management lifecycle, including discovery, detection, verification, risk classification, impact analysis, reporting and mitigation
- It integrates with Rapid7's Metaploit for vulnerability exploitation
- It's sold as standalone software, an appliance, virtual machine, or as a managed service or private cloud deployment. User interaction is through a web browser
- There's a free but limited community edition as well as commercial versions that start at $2000 per user per year
- Download from https://www.rapid7.com/products/nexpose/
- One of the leading vulnerability assessment tools
- It operates across physical, virtual, cloud and mobile environments, to discover the active services, ports, and running apps on each machine, and it tries to identify vulnerabilities that may exist, based on the attributes of the known services and apps

### Some technologies
- Assets: a host on a network
- Site: a logical group of assets that has a dedicated scan engine
- Scan template: a template that defines the audit level that Nexpose uses to perform a vulnerability scan
- Local scan engine: responsible for performing scan jobs on your assets

### Installing Nexpose on Kali
- https://www.rapid7.com/info/nexpose-virtual-appliance/
- Download the Nexpose VM
- Username: nexpose
- Password: nexpose
- Use "ifconfig" in your Nexpose to check your machine's IP address
- URL: https://<Nexpose_IP>:3780
- Click on Advanced, followed by Accept the Risk and continue
- You will be redirected to a login page, given the default username (nxadmin) and password (nxpassword)
- Then you'll be asked for an activation key to provide the license key that you received at your email address
- Then the Nexpose Security Web Console page will activate

### Running vulnerability scans
- Go to the home page, click the Create dropdown, and select Site
- The Security Console will display the "Site Configuration" screen
- On the General tab, we have to give the name and describe our site

### Assets Configuration
- The Assets configuration page comprises of two sections: Include and Exclude
- In the Include section, we've provided our target IP address or if we want to scan the entire network, then we will have to provide the complete IP range
- The Exclude section is used to exclude the IP from scanning. If we're scanning the entire IP range and want to exclude some of the IPs from the scan, we just need to put them in the exclude assets section

### Authentication Section
- Here we put in any credentials
- Basically we conduct a credential-based scan by providing the system with a username and a password

### Templates
- Set up a particular Scan Template - we've used the default Scan Template: Audit without Web Spider

### Engines
- Select the Local Scan Engine
- To begin scanning, click the Save ans Scan button at the upper right corner of your Nexpose console panel

### Results
- Once the scan is complete, the result clearly indicates the number of possessed vulnerabilities, the risk score, and the duration of the scan
- Now we can see all the vulnerabilities mentioned along with their Common Vulnerability Scoring System (CVSS) score from the highest to the lowest over the vulnerabilities tab
- When we click on a particular vulnerability, it will give us info including its severity, whether it's password protected or not, its version, etc

### Reports
- Now we can generate the new records in the Reports tab by simply giving it a title, selecting the scan along with the template, and the report format 